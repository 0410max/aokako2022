<div class='container'>
  <div class='col-md-10 offset-md-1 pt-3'>
    <div id="depSelector" class='kakomon-index'>
      <h2>過去問一覧</h2>
      <%= form_with url: search_kakomons_path,method: :get, local: true do |f| %>
        <%= f.text_field :sub,class:'search mb-3 mr-2',placeholder:'科目名' %>
        <%= f.submit '検索する',class:'search-submit' %>
      <% end %>
    </div>

    <% if @kakomons.count === 0 %>
      <div class='no-kakomon'>
        <p>該当の過去問はありません。</p>
      </div>
    <% else %>
      <table>
        <thead>
          <tr>
            <th colspan='2'></th>
            <th colspan='2'></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <% @kakomons.each do |kakomon| %>
                <article class='index-kakomon-content'>
                  <div class='article-top'>
                    <%= image_tag kakomon.user.get_profile_image,size:'30x30',class:'index-profile-image' %>
                    <%= kakomon.user.name %><br>
                  </div>
                  <div class='article-body'>
                  </div>
                  <div class='article-bottom'>
                    科目 : <%= kakomon.sub %><br>
                    年度 : <%= kakomon.year %><br>
                    学部 : <%= @dep %><br>
                    学科 : <%= @cor %><br>
                    教授 : <%= kakomon.prof %><br>
                    <% unless kakomon.comment === '' %>  <!--ここをコメントがあるときだけ表示するっていう書き方にしたいAWSだからできないのかも-->
                      <span class='kakomon-user-name'><%= kakomon.user.name %></span><%= kakomon.comment %><br>
                    <% end %>
                    <% unless kakomon.comments.count === 0 %>
                      <span class='comment-count'>コメント<%= kakomon.comments.count %>件をみる</span><br>
                    <% end %>
                    <span class='kakomon-date'><%= kakomon.created_at.strftime('%Y/%m/%d') %></span>
                  </div>
                    <div class='article-comment'>
                      <%= form_with(model:[kakomon,@comment], local: true) do |f| %>
                        <i class="fa-light fa-comment-lines"></i>
                        <%= f.text_area :comment,placeholder:"コメントを追加...",class:'comment-form pt-2' %>
                        <%= f.submit "投稿する",class:'btn btn-light comment-submit' %>
                      <% end %>
                    </div>
                </article>
              <% end %>
            </td>
          </tr>
        </tbody>
      </table>
    <% end %>

  </div>


  <div class='col-md-4'>

  </div>
</div>